---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Badge from '../../components/Badge.astro';
import Button from '../../components/Button.astro';
import { getCollection } from 'astro:content';
import { site } from '../../data/site';

export async function getStaticPaths() {
  const projects = await getCollection('projects');
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

const { project } = Astro.props;
const { Content } = await project.render();
const { data } = project;
---

<BaseLayout title={`${data.title} - ${site.name}`} description={data.description}>
  <section class="section">
    <div class="container">
      <p class="eyebrow">Project</p>
      <h1 class="headline">{data.title}</h1>
      <p class="subhead">{data.description}</p>
      <div class="tag-list" style="margin: var(--space-4) 0;">
        {data.tags.map((tag) => (
          <Badge label={tag} />
        ))}
      </div>
      <div class="tag-list" style="margin-bottom: var(--space-4);">
        {data.stack.map((item) => (
          <span class="kicker">{item}</span>
        ))}
      </div>
      <div style="display: flex; gap: var(--space-3); flex-wrap: wrap;">
        {data.links?.caseStudy && (
          <Button href={data.links.caseStudy} variant="outline">
            Read case study
          </Button>
        )}
        {data.links?.demo && (
          <Button href={data.links.demo} variant="ghost">
            Live demo
          </Button>
        )}
        {data.links?.repo && (
          <Button href={data.links.repo} variant="ghost">
            Repository
          </Button>
        )}
      </div>
      {data.highlights?.length && (
        <div class="surface" style="margin-top: var(--space-5);">
          <h2 style="font-size: var(--step-2); margin-bottom: var(--space-3);">Highlights</h2>
          <ul>
            {data.highlights.map((item) => (
              <li>{item}</li>
            ))}
          </ul>
        </div>
      )}
    </div>
  </section>

  <section class="section" style="padding-top: 0;">
    <div class="container">
      <div class="surface">
        <Content />
      </div>
    </div>
  </section>
</BaseLayout>
